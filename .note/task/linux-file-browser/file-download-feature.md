# æ–‡ä»¶ä¸‹è½½åŠŸèƒ½ä¸“é¡¹ä»»åŠ¡

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°

ä¸ºAI SSH Toolçš„æ–‡ä»¶æµè§ˆå™¨æ·»åŠ å®Œæ•´çš„æ–‡ä»¶ä¸‹è½½åŠŸèƒ½ï¼Œæä¾›ç°ä»£åŒ–çš„UIç•Œé¢ã€è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒå’Œå¼ºå¤§çš„åŠŸèƒ½ç‰¹æ€§ã€‚

## ğŸ¯ é¡¹ç›®ç›®æ ‡

### æ ¸å¿ƒåŠŸèƒ½
- âœ… å•æ–‡ä»¶ä¸‹è½½
- âœ… æ‰¹é‡æ–‡ä»¶ä¸‹è½½  
- âœ… æ–­ç‚¹ç»­ä¼ 
- âœ… ä¸‹è½½è¿›åº¦æ˜¾ç¤º
- âœ… ä¸‹è½½é˜Ÿåˆ—ç®¡ç†
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•

### ç”¨æˆ·ä½“éªŒ
- ğŸ¨ ç°ä»£åŒ–UIè®¾è®¡
- ğŸš€ ä¸€é”®ä¸‹è½½æ“ä½œ
- ğŸ“Š å®æ—¶è¿›åº¦åé¦ˆ
- ğŸ”” ä¸‹è½½å®Œæˆé€šçŸ¥
- ğŸ“ æ™ºèƒ½è·¯å¾„é€‰æ‹©

## ğŸ—ï¸ æŠ€æœ¯æ–¹æ¡ˆ

### æŠ€æœ¯é€‰å‹è¯´æ˜

**ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸‹è½½ç»„ä»¶**ï¼ŒåŸºäºé¡¹ç›®ç°æœ‰æŠ€æœ¯æ ˆè‡ªä¸»å®ç°ï¼š

#### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **SFTPä¼ è¾“**: åŸºäºç°æœ‰çš„`ssh2`å’Œ`ssh2-sftp-client`
- **è¿›åº¦è·Ÿè¸ª**: ä½¿ç”¨Node.js Stream APIç›‘å¬æ•°æ®ä¼ è¾“
- **UIç»„ä»¶**: åŸºäºAnt Designç»„ä»¶åº“è‡ªå®šä¹‰å®ç°
- **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨MobXè¿›è¡Œä¸‹è½½çŠ¶æ€ç®¡ç†
- **æ–‡ä»¶ç³»ç»Ÿ**: Electronçš„dialog APIé€‰æ‹©ä¿å­˜è·¯å¾„

#### å®ç°ä¼˜åŠ¿
1. **æ— é¢å¤–ä¾èµ–**: å……åˆ†åˆ©ç”¨ç°æœ‰æŠ€æœ¯æ ˆ
2. **æ·±åº¦é›†æˆ**: ä¸ç°æœ‰SFTPæœåŠ¡æ— ç¼é›†æˆ
3. **å¯æ§æ€§å¼º**: å®Œå…¨æ§åˆ¶ä¸‹è½½é€»è¾‘å’Œé”™è¯¯å¤„ç†
4. **æ€§èƒ½ä¼˜åŒ–**: é’ˆå¯¹SSHæ–‡ä»¶ä¼ è¾“åœºæ™¯ä¼˜åŒ–

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å‰ç«¯UIå±‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DownloadDialog  â”‚ DownloadProgress  â”‚
â”‚ DownloadManager â”‚ DownloadNotify    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æœåŠ¡å±‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DownloadService â”‚ DownloadQueue     â”‚
â”‚ ProgressTracker â”‚ StateManager      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ä¸»è¿›ç¨‹IPCå±‚                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FileDownloadHandler                 â”‚
â”‚ ProgressReporter                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº•å±‚ä¼ è¾“å±‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SFTP Client (ssh2)                  â”‚
â”‚ File System (fs)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ ç»„ä»¶è®¾è®¡

### 1. DownloadDialog - ä¸‹è½½é…ç½®å¯¹è¯æ¡†
```typescript
interface DownloadDialogProps {
  file: FileEntry;
  visible: boolean;
  onConfirm: (config: DownloadConfig) => void;
  onCancel: () => void;
}
```

**åŠŸèƒ½ç‰¹æ€§:**
- æ–‡ä»¶ä¿¡æ¯å±•ç¤ºï¼ˆåç§°ã€å¤§å°ã€è·¯å¾„ï¼‰
- ä¿å­˜ä½ç½®é€‰æ‹©ï¼ˆè®°ä½ä¸Šæ¬¡ä½ç½®ï¼‰
- æ–‡ä»¶åç¼–è¾‘
- ä¸‹è½½é€‰é¡¹é…ç½®ï¼ˆè¦†ç›–ã€æ‰“å¼€æ–‡ä»¶å¤¹ç­‰ï¼‰

### 2. DownloadProgress - ä¸‹è½½è¿›åº¦ç»„ä»¶
```typescript
interface DownloadProgressProps {
  taskId: string;
  fileName: string;
  progress: number;
  speed: number;
  remainingTime: number;
  status: DownloadStatus;
}
```

**åŠŸèƒ½ç‰¹æ€§:**
- åœ†å½¢è¿›åº¦æ¡æ˜¾ç¤º
- å®æ—¶é€Ÿåº¦å’Œå‰©ä½™æ—¶é—´
- æš‚åœ/æ¢å¤/å–æ¶ˆæ“ä½œ
- çŠ¶æ€å›¾æ ‡å’Œæ–‡å­—æç¤º

### 3. DownloadManager - ä¸‹è½½ç®¡ç†é¢æ¿
```typescript
interface DownloadManagerProps {
  tasks: DownloadTask[];
  onPause: (taskId: string) => void;
  onResume: (taskId: string) => void;
  onCancel: (taskId: string) => void;
  onRetry: (taskId: string) => void;
}
```

**åŠŸèƒ½ç‰¹æ€§:**
- ä¸‹è½½ä»»åŠ¡åˆ—è¡¨
- æ‰¹é‡æ“ä½œï¼ˆå…¨éƒ¨æš‚åœ/æ¢å¤ï¼‰
- ä¸‹è½½å†å²è®°å½•
- ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º

## ğŸ”§ æ ¸å¿ƒæœåŠ¡

### DownloadService - ä¸‹è½½æœåŠ¡
```typescript
class DownloadService {
  // å¼€å§‹ä¸‹è½½
  async startDownload(config: DownloadConfig): Promise<string>
  
  // æš‚åœä¸‹è½½
  async pauseDownload(taskId: string): Promise<void>
  
  // æ¢å¤ä¸‹è½½
  async resumeDownload(taskId: string): Promise<void>
  
  // å–æ¶ˆä¸‹è½½
  async cancelDownload(taskId: string): Promise<void>
  
  // è·å–ä¸‹è½½è¿›åº¦
  getProgress(taskId: string): DownloadProgress
}
```

### ProgressTracker - è¿›åº¦è·Ÿè¸ªå™¨
```typescript
class ProgressTracker {
  // è®¡ç®—ä¸‹è½½é€Ÿåº¦
  calculateSpeed(bytesTransferred: number, timeElapsed: number): number
  
  // ä¼°ç®—å‰©ä½™æ—¶é—´
  estimateRemainingTime(totalSize: number, transferred: number, speed: number): number
  
  // æ›´æ–°è¿›åº¦
  updateProgress(taskId: string, progress: DownloadProgress): void
}
```

## ğŸ“‹ å¼€å‘è®¡åˆ’

### Phase 1: åŸºç¡€ä¸‹è½½åŠŸèƒ½ (Week 1) âœ… **å·²å®Œæˆ**
- [x] åˆ›å»ºä¸‹è½½å¯¹è¯æ¡†ç»„ä»¶
- [x] å®ç°æ–‡ä»¶ä¿å­˜ä½ç½®é€‰æ‹©
- [x] æ·»åŠ åŸºç¡€SFTPä¸‹è½½åŠŸèƒ½
- [x] é›†æˆåˆ°å³é”®èœå•

### Phase 2: è¿›åº¦å’ŒçŠ¶æ€ç®¡ç† (Week 2) âœ… **å·²å®Œæˆ**
- [x] å®ç°ä¸‹è½½è¿›åº¦è·Ÿè¸ª
- [x] æ·»åŠ ä¸‹è½½é€Ÿåº¦è®¡ç®—
- [x] åˆ›å»ºä¸‹è½½çŠ¶æ€ç®¡ç†
- [x] å®ç°ä¸‹è½½é€šçŸ¥ç³»ç»Ÿ

### Phase 3: é«˜çº§åŠŸèƒ½ (Week 3)
- [ ] æ”¯æŒæ–­ç‚¹ç»­ä¼ 
- [ ] æ·»åŠ ä¸‹è½½é˜Ÿåˆ—ç®¡ç†
- [ ] å®ç°æ‰¹é‡ä¸‹è½½
- [ ] æ·»åŠ ä¸‹è½½å†å²è®°å½•å’ŒæŸ¥çœ‹çš„æŒ‰é’®ï¼ˆå®ç°å†…å­˜å°±è¡Œï¼Œä¸ç”¨ç£ç›˜ï¼‰ï¼ŒæŒ‰é’®æ”¾åœ¨main.tsé¡¶éƒ¨èœå•æ ï¼Œæ–°å»ºä¸€ä¸ªâ€œæŸ¥çœ‹â€çš„èœå•é¡¹ï¼Œæ”¾åœ¨æŸ¥çœ‹ä¸‹é¢

### Phase 4: ä¼˜åŒ–å’Œå®Œå–„ (Week 4)
- [ ] æ€§èƒ½ä¼˜åŒ–

## ğŸ¨ UIè®¾è®¡è§„èŒƒ

### è‰²å½©æ–¹æ¡ˆ
- ä¸»è‰²è°ƒ: #1890ff (Ant Design Primary)
- æˆåŠŸè‰²: #52c41a
- è­¦å‘Šè‰²: #faad14  
- é”™è¯¯è‰²: #ff4d4f
- èƒŒæ™¯è‰²: #1E1E1E (æ·±è‰²ä¸»é¢˜)

### ç»„ä»¶æ ·å¼
- åœ†è§’: 4px
- é˜´å½±: 0 2px 8px rgba(0, 0, 0, 0.15)
- å­—ä½“: 13px (èœå•), 14px (æ­£æ–‡)
- é—´è·: 8px, 16px, 24px

### åŠ¨ç”»æ•ˆæœ
- è¿›åº¦æ¡åŠ¨ç”»: 300ms ease
- å¼¹çª—åŠ¨ç”»: 200ms ease-out
- çŠ¶æ€åˆ‡æ¢: 150ms ease

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### ä¸‹è½½æ€§èƒ½
- æ”¯æŒæ–‡ä»¶å¤§å°: æ— é™åˆ¶
- å¹¶å‘ä¸‹è½½æ•°: æœ€å¤š5ä¸ª
- å†…å­˜å ç”¨: < 100MB (å•ä¸ªå¤§æ–‡ä»¶)
- æ–­ç‚¹ç»­ä¼ : æ”¯æŒ

### ç”¨æˆ·ä½“éªŒ
- å“åº”æ—¶é—´: < 200ms
- è¿›åº¦æ›´æ–°é¢‘ç‡: æ¯100ms
- é”™è¯¯æ¢å¤æ—¶é—´: < 3s



## ğŸ“‚ ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯å®ç°æ–¹æ¡ˆ](./technical-implementation.md) - è¯¦ç»†çš„æŠ€æœ¯æ¶æ„å’Œå®ç°åŸç†
- [UIè®¾è®¡è§„èŒƒ](./ui-design-specs.md) - å®Œæ•´çš„ç•Œé¢è®¾è®¡è§„èŒƒå’Œæ ·å¼æŒ‡å—
- [å®ç°æŒ‡å—](./implementation-guide.md) - ç¬¬ä¸€é˜¶æ®µå®ç°å®Œæˆè¯´æ˜å’Œä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šäº†è§£ç°æœ‰æ¶æ„
1. æŸ¥çœ‹ç°æœ‰SFTPæœåŠ¡å®ç°: `src/renderer/services/sftp.ts`
2. äº†è§£æ–‡ä»¶æµè§ˆå™¨ç»„ä»¶: `src/renderer/components/FileBrowser/`
3. ç†Ÿæ‚‰å³é”®èœå•å®ç°: `src/renderer/components/FileBrowser/FileList/components/ContextMenu/`

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåŸºç¡€ç»„ä»¶
1. åˆ›å»ºä¸‹è½½å¯¹è¯æ¡†: `src/renderer/components/Download/DownloadDialog.tsx`
2. å®ç°ä¸‹è½½æœåŠ¡: `src/renderer/services/downloadService.ts`
3. æ·»åŠ ä¸»è¿›ç¨‹IPCå¤„ç†: `src/main/ipc/download.ts`

### ç¬¬ä¸‰æ­¥ï¼šé›†æˆåˆ°ç°æœ‰ç³»ç»Ÿ
1. ä¿®æ”¹å³é”®èœå•ï¼Œæ·»åŠ ä¸‹è½½åŠŸèƒ½
2. é›†æˆåˆ°æ–‡ä»¶æµè§ˆå™¨ä¸»ç•Œé¢
3. æ·»åŠ ä¸‹è½½çŠ¶æ€æ˜¾ç¤º

## ğŸ”— æŠ€æœ¯ä¾èµ–

### ç°æœ‰ä¾èµ–ï¼ˆæ— éœ€æ–°å¢ï¼‰
- `ssh2`: SSH2åè®®å®ç°
- `ssh2-sftp-client`: SFTPå®¢æˆ·ç«¯
- `electron`: æ¡Œé¢åº”ç”¨æ¡†æ¶
- `antd`: UIç»„ä»¶åº“
- `react`: å‰ç«¯æ¡†æ¶
- `mobx`: çŠ¶æ€ç®¡ç†

### å¯èƒ½éœ€è¦çš„å·¥å…·åº“
- `uuid`: ç”Ÿæˆå”¯ä¸€ä»»åŠ¡ID
- `path`: è·¯å¾„å¤„ç†
- `fs`: æ–‡ä»¶ç³»ç»Ÿæ“ä½œ

---

**åˆ›å»ºæ—¶é—´**: 2024-12-22
**è´Ÿè´£äºº**: AI Assistant
**é¢„è®¡å®Œæˆ**: 2025-01-22
**ä¼˜å…ˆçº§**: é«˜
