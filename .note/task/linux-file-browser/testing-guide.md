# 文件下载功能测试指南

## 🧪 测试准备

### 环境要求
- 已启动的AI SSH Tool应用
- 可访问的SSH服务器
- 测试用的文件（不同大小）

### 测试文件建议
```bash
# 在SSH服务器上创建测试文件
echo "Hello World" > small_file.txt                    # 小文件 (~12B)
dd if=/dev/zero of=medium_file.dat bs=1M count=10      # 中等文件 (10MB)
dd if=/dev/zero of=large_file.dat bs=1M count=100      # 大文件 (100MB)
```

## 📋 测试用例

### 1. 基础功能测试

#### 测试用例 1.1: 小文件下载
**目标**: 验证小文件下载的基本功能
**步骤**:
1. 连接SSH服务器
2. 在文件浏览器中找到 `small_file.txt`
3. 右键点击文件
4. 选择"下载"
5. 在下载对话框中选择保存位置
6. 点击"开始下载"

**预期结果**:
- 下载对话框正确显示文件信息
- 下载立即完成
- 文件保存到指定位置
- 显示下载完成通知

#### 测试用例 1.2: 中等文件下载
**目标**: 验证中等大小文件的下载和进度显示
**步骤**:
1. 右键点击 `medium_file.dat`
2. 选择"下载"
3. 配置下载选项
4. 开始下载
5. 观察进度显示

**预期结果**:
- 进度条正常显示
- 速度和剩余时间计算正确
- 下载完成后文件大小正确

#### 测试用例 1.3: 大文件下载
**目标**: 验证大文件下载的稳定性
**步骤**:
1. 下载 `large_file.dat`
2. 观察内存使用情况
3. 等待下载完成

**预期结果**:
- 内存使用保持稳定
- 进度显示平滑
- 下载成功完成

### 2. 交互功能测试

#### 测试用例 2.1: 暂停和恢复
**目标**: 验证下载的暂停和恢复功能
**步骤**:
1. 开始下载大文件
2. 在下载过程中点击"暂停"
3. 等待几秒后点击"恢复"
4. 等待下载完成

**预期结果**:
- 暂停后下载停止
- 恢复后下载继续
- 最终文件完整

#### 测试用例 2.2: 取消下载
**目标**: 验证取消下载功能
**步骤**:
1. 开始下载文件
2. 在下载过程中点击"取消"
3. 检查本地文件

**预期结果**:
- 下载立即停止
- 部分下载的文件被删除
- 任务状态更新为"已取消"

#### 测试用例 2.3: 文件覆盖
**目标**: 验证文件覆盖功能
**步骤**:
1. 下载一个文件到本地
2. 再次下载同一个文件到相同位置
3. 在对话框中选择"覆盖同名文件"
4. 开始下载

**预期结果**:
- 原文件被覆盖
- 新文件下载成功

### 3. 错误处理测试

#### 测试用例 3.1: 磁盘空间不足
**目标**: 验证磁盘空间不足时的错误处理
**步骤**:
1. 选择一个磁盘空间不足的位置
2. 尝试下载大文件

**预期结果**:
- 显示明确的错误信息
- 部分文件被清理

#### 测试用例 3.2: 网络中断
**目标**: 验证网络中断时的处理
**步骤**:
1. 开始下载文件
2. 在下载过程中断开网络连接
3. 恢复网络连接

**预期结果**:
- 显示网络错误
- 提供重试选项

#### 测试用例 3.3: 权限不足
**目标**: 验证目标目录权限不足的处理
**步骤**:
1. 选择一个只读目录作为保存位置
2. 尝试下载文件

**预期结果**:
- 显示权限错误信息
- 提示选择其他位置

### 4. 并发测试

#### 测试用例 4.1: 多文件同时下载
**目标**: 验证同时下载多个文件的功能
**步骤**:
1. 同时启动3-5个文件的下载
2. 观察系统性能
3. 等待所有下载完成

**预期结果**:
- 所有下载正常进行
- 系统保持响应
- 所有文件下载成功

#### 测试用例 4.2: 下载管理器
**目标**: 验证下载管理器的功能
**步骤**:
1. 启动多个下载任务
2. 打开下载管理器
3. 测试批量操作功能

**预期结果**:
- 正确显示所有任务
- 统计信息准确
- 批量操作正常工作

## 🔍 性能测试

### 内存使用测试
**目标**: 确保下载大文件时内存使用合理
**方法**:
1. 使用任务管理器监控内存使用
2. 下载100MB以上的文件
3. 记录内存峰值

**标准**: 内存使用不应超过100MB

### 速度测试
**目标**: 验证下载速度是否合理
**方法**:
1. 下载已知大小的文件
2. 记录下载时间
3. 计算平均速度

**标准**: 速度应接近网络带宽限制

### UI响应测试
**目标**: 确保下载时界面不卡顿
**方法**:
1. 在下载过程中操作界面
2. 测试其他功能是否正常
3. 观察进度更新是否平滑

**标准**: 界面操作响应时间 < 200ms

## 📊 测试报告模板

### 测试环境
- 操作系统: 
- 应用版本: 
- SSH服务器: 
- 网络环境: 

### 测试结果
| 测试用例 | 状态 | 备注 |
|---------|------|------|
| 1.1 小文件下载 | ✅/❌ | |
| 1.2 中等文件下载 | ✅/❌ | |
| 1.3 大文件下载 | ✅/❌ | |
| 2.1 暂停和恢复 | ✅/❌ | |
| 2.2 取消下载 | ✅/❌ | |
| 2.3 文件覆盖 | ✅/❌ | |
| 3.1 磁盘空间不足 | ✅/❌ | |
| 3.2 网络中断 | ✅/❌ | |
| 3.3 权限不足 | ✅/❌ | |
| 4.1 多文件下载 | ✅/❌ | |
| 4.2 下载管理器 | ✅/❌ | |

### 性能指标
- 最大内存使用: ___MB
- 平均下载速度: ___MB/s
- UI响应时间: ___ms

### 发现的问题
1. 
2. 
3. 

### 改进建议
1. 
2. 
3. 

---

**测试指南版本**: v1.0  
**创建时间**: 2024-12-22  
**适用版本**: 第一阶段实现
